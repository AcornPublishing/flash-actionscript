<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="desref.css" type="text/css"><h1><a name="_Toc16483053"></a><a name="_Toc16512744"><span lang=EN-US> TextFormat.getTextExtent</span></a></h1><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>myTextFormat.getTextExtent (text)</span></span> </p><p class=MsoBodyText>&nbsp;</p><p class=MsoBodyText><span lang=EN-US> Where </span><spanclass=Code><span style='font-family:Courier'>myTextFormat</span></span> <spanlang=EN-US> is a </span><span class=Code><spanstyle='font-family:Courier'>TextFormat</span></span> <span lang=EN-US>  instance and text is a string.</span></p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> Compatible with </span></span> <spanclass=ImportantWord><span style='font-family:Helvetica'>Flash Player 6 andlater</span></span> <span class=Code><span lang=EN-US>. </span></span> </p><p class=MsoBodyText><span lang=EN-US> &nbsp;</span></p><p class=MsoBodyText><span lang=EN-US> The </span><spanclass=Code><span lang=EN-US style='font-family:Courier;'>TextFormat.getTextExtent</span></span> <spanclass=Code><span lang=EN-US>  method returns the size of the text field thatwould display all of the string <i>text, </i>given that the text formattingspecified by </span></span> <span class=Code><span style='font-family:Courier'>myTextFormat</span></span> <span class=Code><spanlang=EN-US>is applied to it. Unfortunately, the method isinaccurate and cannot be relied upon.</span></span> </p><h3><span lang=EN-US> Description</span></h3><p class=MsoBodyText><span lang=EN-US> The </span><spanclass=Code><span lang=EN-US style='font-family:Courier;'>TextFormat.getTextExtent</span></span> <span class=ImportantWord><spanstyle='font-family:Helvetica'>method</span></span> <span lang=EN-US> returnsthe size of the specified text string as an </span><span class=Code><spanstyle='font-family:Courier'>Object</span></span> <span lang=EN-US>  object with properties of width and height.This object defines the size (in pixels) that a single line text field wouldhave to be to display the string (as plain text with HTML and control codeformatting ignored), when the string is formatted via the text format object.</span></p><p class=MsoBodyText><span lang=EN-US> &nbsp;</span></p><p class=MsoBodyText><span lang=EN-US> This wouldallow you to resize a text field after the text format object is applied, suchthat all the text is still visible. Unfortunately, the method returnsinaccurate values, and in tests was found to resize the text field too small inmany cases. It cannot be therefore relied upon, and should not be used.</span></p><h3><span lang=EN-US> Examples and practicaluses</span></h3><p class=MsoBodyText><span lang=EN-US> The </span><spanclass=Code><span lang=EN-US style='font-family:Courier;'>TextFormat.getTextExtent</span></span> <spanclass=Code><span lang=EN-US>  method </span></span> <span lang=EN-US> returns the width and height of the text stringspecified as a parameter, returning the results as two properties of an </span><spanclass=Code><span style='font-family:Courier'>Object</span></span> <spanlang=EN-US> object:</span></p><p class=MsoBodyText>&nbsp;</p><p class=MsoBodyText><span class=Code><span lang=EN-US> Consider thefollowing text field:</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'><img width=612 height=150src="../png/0586_dict11_34.png"></span></span> </p><p class=MsoBodyText>&nbsp;</p><p class=MsoBodyText><span class=Code><span lang=EN-US> The text field uses </span></span> <spanclass=Code><span style='font-family:Courier'>8</span></span> <span class=Code><spanlang=EN-US> point </span></span> <span class=Code><spanstyle='font-family:Courier'>_sans</span></span> <span class=Code><spanlang=EN-US>, and is set up to display a single line of text.Supposing we wanted to change the text so that it was instead 20 point. Wewould obviously have to resize the text field, but by how much?</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> Consider thefollowing lines:</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>myTextFormat = new TextFormat();</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>myTextFormat = my_txt.getNewTextFormat();</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> This retrieves thecurrent text formatting of our text field </span></span> <span class=Code><spanstyle='font-family:Courier'>my_txt</span></span> <span class=Code><span lang=EN-US> and creates a new </span></span> <spanclass=Code><span style='font-family:Courier'>TextFormat</span></span> <spanclass=Code><span lang=EN-US>  object that contains the same values.</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> If we wanted to nowsee how big our text field has to be to accommodate the same text if the textwas now 20 point, we have to:</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=Bullet-Level1><span class=Code><span lang=EN-USstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> </span><span class=Code><span lang=EN-US> Change the sizeproperty of our text format, </span></span> <span class=Code><span lang=EN-USstyle='font-family:Courier'>myTextFormat</span></span> <spanclass=Code><span lang=EN-US> to 20.</span></span> </p><p class=Bullet-Level1><span class=Code><span lang=EN-USstyle='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> </span><span class=Code><span lang=EN-US> Use the </span></span> <spanclass=Code><span lang=EN-US style='font-family:Courier'>getTextExtent</span></span> <span class=Code><span lang=EN-US> method to create an object that contains thenew height and width values as properties, using the text in </span></span> <spanclass=Code><span lang=EN-US style='font-family:Courier'>my_txt</span></span> <span class=Code><span lang=EN-US> as the argument (which we do via </span></span> <spanclass=Code><span lang=EN-US style='font-family:Courier'>TextField.text</span></span> <spanclass=Code><span lang=EN-US>.</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>myTextFormat.size = 20;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>resize = myTextFormat.getTextExtent(my_txt.text);</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> This creates an </span></span> <spanclass=Code><span style='font-family:Courier'>Object</span></span> <spanclass=Code><span lang=EN-US>  object </span></span> <span class=Code><spanstyle='font-family:Courier'>resize</span></span> <span class=Code><span lang=EN-US> with properties </span></span> <spanclass=Code><span style='font-family:Courier'>width</span></span> <span class=Code><spanlang=EN-US>and </span></span> <span class=Code><spanstyle='font-family:Courier'>height</span></span> :</p><p class=MsoBodyText><span class=Code><i><span lang=EN-US> &nbsp;</span></i></span></p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'><img width=140 height=43src="../png/0586_dict11_35.png"></span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> We can allegedly usethese values to resize </span></span> <span class=Code><span style='font-family:Courier'>my_txt</span></span> <spanclass=Code><span lang=EN-US> before applying </span></span> <span class=Code><spanstyle='font-family:Courier'>myTextFormat</span></span> <span class=Code><span lang=EN-US> (which will bow setthe text size to 20 point:</span></span> </p><p class=MsoBodyText><span class=Code><i><span lang=EN-US> &nbsp;</span></i></span></p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>my_txt._width = resize.width;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>my_txt._height = resize.height;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'>my_txt.setTextFormat(myTextFormat);</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> If all goes well, weshould have a nice big text field that perfectly accommodates our nice newtext... unfortunately it doesn't work:</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US style='font-family:Courier;'><img width=331 height=93src="../png/0586_dict11_36.png"></span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> &nbsp;</span></span> </p><p class=MsoBodyText><span class=Code><span lang=EN-US> The text field isconsistently resized too small, and doesn't take into account the &quot;belowthe line&quot; parts of characters such as &quot;</span></span> <spanclass=Code><span style='font-family:Courier'>y</span></span> <span class=Code><spanlang=EN-US>&quot;.</span></span> </p><h3><span lang=EN-US> Tips and precautions</span></h3><p class=MsoBodyText><span lang=EN-US> If youneed to resize your text fields, consider using </span><spanclass=ImportantWord><span style='font-family:Helvetica'>TextField.autosize </span></span> <spanlang=EN-US>as a work around.</span></p>